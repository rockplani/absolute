{
  "{\"filename\":\"/home/garlicb/study/token/absolute/gulpfile.babel.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{\"strict\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/home/garlicb/study/token/absolute\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.25.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "gulp-babel",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "babel"
              }
            ]
          },
          {
            "source": "child_process",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "childProcess"
              }
            ]
          },
          {
            "source": "gulp-eslint",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "eslint"
              }
            ]
          },
          {
            "source": "./server/push/gen_push_key",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "generatePushKey"
              }
            ]
          },
          {
            "source": "gulp",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "gulp"
              }
            ]
          },
          {
            "source": "gulp-mocha",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mocha"
              }
            ]
          },
          {
            "source": "gulp-nodemon",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "nodemon"
              }
            ]
          },
          {
            "source": "path",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "path"
              }
            ]
          },
          {
            "source": "run-sequence",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "runSequence"
              }
            ]
          },
          {
            "source": "gulp-sourcemaps",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "sourcemaps"
              }
            ]
          },
          {
            "source": "gulp-undef-task-to-default",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "undefTaskToDefault"
              }
            ]
          },
          {
            "source": "webpack",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "webpack"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/home/garlicb/study/token/absolute/gulpfile.babel.js",
      "filenameRelative": "/home/garlicb/study/token/absolute/gulpfile.babel.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "strict": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "gulpfile.babel.js",
      "sourceFileName": "gulpfile.babel.js",
      "sourceRoot": "/home/garlicb/study/token/absolute",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/home/garlicb/study/token/absolute",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "gulpfile.babel"
    },
    "ignored": false,
    "code": "var _gulpBabel = require('gulp-babel');\n\nvar _gulpBabel2 = _interopRequireDefault(_gulpBabel);\n\nvar _child_process = require('child_process');\n\nvar _child_process2 = _interopRequireDefault(_child_process);\n\nvar _gulpEslint = require('gulp-eslint');\n\nvar _gulpEslint2 = _interopRequireDefault(_gulpEslint);\n\nvar _gen_push_key = require('./server/push/gen_push_key');\n\nvar _gen_push_key2 = _interopRequireDefault(_gen_push_key);\n\nvar _gulp = require('gulp');\n\nvar _gulp2 = _interopRequireDefault(_gulp);\n\nvar _gulpMocha = require('gulp-mocha');\n\nvar _gulpMocha2 = _interopRequireDefault(_gulpMocha);\n\nvar _gulpNodemon = require('gulp-nodemon');\n\nvar _gulpNodemon2 = _interopRequireDefault(_gulpNodemon);\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _runSequence = require('run-sequence');\n\nvar _runSequence2 = _interopRequireDefault(_runSequence);\n\nvar _gulpSourcemaps = require('gulp-sourcemaps');\n\nvar _gulpSourcemaps2 = _interopRequireDefault(_gulpSourcemaps);\n\nvar _gulpUndefTaskToDefault = require('gulp-undef-task-to-default');\n\nvar _gulpUndefTaskToDefault2 = _interopRequireDefault(_gulpUndefTaskToDefault);\n\nvar _webpack = require('webpack');\n\nvar _webpack2 = _interopRequireDefault(_webpack);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Copyright (c) 2017 The Absolute Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nprocess.on('exit', function () {\n  (0, _runSequence2.default)('stop');\n});\n\nprocess.on('SIGINT', function () {\n  (0, _runSequence2.default)('stop');\n});\n\nprocess.on('uncaughtException', function () {\n  (0, _runSequence2.default)('stop');\n});\n\nprocess.on('disconnect', function () {\n  (0, _runSequence2.default)('stop');\n});\n\n_gulp2.default.task('default', ['help']);\n\n_gulp2.default.task('help', function () {\n  // TODO(zino): We should implement this command.\n});\n\n_gulp2.default.task('build_server', function () {\n  return _gulp2.default.src(['./server/**/*.js']).pipe(_gulpSourcemaps2.default.init()).pipe((0, _gulpBabel2.default)()).on('error', function (error) {\n    console.log(error);\n  }).pipe(_gulpSourcemaps2.default.write('.', { sourceRoot: _path2.default.resolve(__dirname, 'server') })).pipe(_gulp2.default.dest(_path2.default.resolve(__dirname, 'out', 'server')));\n});\n\n_gulp2.default.task('lint', function (finish) {\n  (0, _runSequence2.default)('lint_server', 'lint_router', finish);\n});\n\n_gulp2.default.task('lint_server', function (finish) {\n  return _gulp2.default.src(['./server/**/*.js', '!./server/**/*.router.js', '!./server/push/push_key.js']).pipe((0, _gulpEslint2.default)()).pipe(_gulpEslint2.default.format()).pipe(_gulpEslint2.default.failAfterError());\n});\n\n_gulp2.default.task('lint_router', function (finish) {\n  return _gulp2.default.src(['./server/**/*.router.js']).pipe((0, _gulpEslint2.default)({\n    'rules': {\n      'require-jsdoc': ['error', {\n        'require': {\n          'MethodDefinition': false,\n          'ClassDeclaration': false } }] } })).pipe(_gulpEslint2.default.format()).pipe(_gulpEslint2.default.failAfterError());\n});\n\n_gulp2.default.task('push_key', function () {\n  (0, _gen_push_key2.default)();\n});\n\n_gulp2.default.task('start', function () {\n  (0, _runSequence2.default)('start_db', 'lint', 'push_key', 'build_server', 'build_client', 'start_server');\n});\n\n_gulp2.default.task('start_server', function () {\n  (0, _gulpNodemon2.default)({\n    script: 'server.js',\n    cwd: 'out/server'\n  });\n});\n\n_gulp2.default.task('start_db', function (finish) {\n  _child_process2.default.exec('mongod --fork --dbpath database --logpath database/log', function (error) {\n    if (error) console.log('Already running mongo DB daemon..');else console.log('Running mongo DB daemon..');\n    finish();\n  });\n});\n\n// FIXME(zino): This command is not working well in some cases. (e.g. CTRL + C)\n_gulp2.default.task('stop', function (finish) {\n  _child_process2.default.exec('mongo admin --eval \"db.shutdownServer();\"', function (error) {\n    setTimeout(function () {\n      finish();\n    }, 1000);\n  });\n});\n\n_gulp2.default.task('bootstrap_test', function () {\n  _gulp2.default.src(['bootstrap/test/test-*.js'], { read: false }).pipe((0, _gulpMocha2.default)()).once('error', function () {\n    process.exit(1);\n  }).once('end', function () {\n    process.exit();\n  });\n});\n\n_gulp2.default.task('build_client', function () {\n  _gulp2.default.src([_path2.default.resolve(__dirname, 'client', 'index.html'), _path2.default.resolve(__dirname, 'client', 'service-worker.js')]).pipe(_gulp2.default.dest(_path2.default.resolve(__dirname, 'out', 'client')));\n  (0, _webpack2.default)({\n    watch: true,\n    context: _path2.default.resolve(__dirname, 'client'),\n    entry: './app.js',\n    output: {\n      path: _path2.default.resolve(__dirname, 'out', 'client', 'javascript'),\n      filename: 'bundle.js' },\n    module: {\n      rules: [{\n        test: /\\.js$/,\n        use: [{\n          loader: 'babel-loader',\n          options: {\n            presets: [['es2015-without-strict']] } }] }, {\n        test: /\\.scss$/,\n        use: ['style-loader', 'css-loader', 'sass-loader'] }, {\n        test: /\\.(png|jpg)$/,\n        use: [{\n          loader: 'url-loader',\n          options: { limit: 10000 } }] }] },\n    plugins: [new _webpack2.default.optimize.UglifyJsPlugin({\n      include: /\\.min\\.js$/,\n      minimize: true })] }, function (err, stats) {\n    // FIXME(cs-lee) save log in file\n  });\n});\n\n(0, _gulpUndefTaskToDefault2.default)(_gulp2.default);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImd1bHBmaWxlLmJhYmVsLmpzIl0sIm5hbWVzIjpbInByb2Nlc3MiLCJvbiIsInRhc2siLCJzcmMiLCJwaXBlIiwiaW5pdCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIndyaXRlIiwic291cmNlUm9vdCIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJkZXN0IiwiZmluaXNoIiwiZm9ybWF0IiwiZmFpbEFmdGVyRXJyb3IiLCJzY3JpcHQiLCJjd2QiLCJleGVjIiwic2V0VGltZW91dCIsInJlYWQiLCJvbmNlIiwiZXhpdCIsIndhdGNoIiwiY29udGV4dCIsImVudHJ5Iiwib3V0cHV0IiwicGF0aCIsImZpbGVuYW1lIiwibW9kdWxlIiwicnVsZXMiLCJ0ZXN0IiwidXNlIiwibG9hZGVyIiwib3B0aW9ucyIsInByZXNldHMiLCJsaW1pdCIsInBsdWdpbnMiLCJvcHRpbWl6ZSIsIlVnbGlmeUpzUGx1Z2luIiwiaW5jbHVkZSIsIm1pbmltaXplIiwiZXJyIiwic3RhdHMiXSwibWFwcGluZ3MiOiJBQWNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWVBQSxRQUFRQyxFQUFSLENBQVcsTUFBWCxFQUFtQixZQUFNO0FBQ3ZCLDZCQUFZLE1BQVo7QUFDRCxDQUZEOztBQUlBRCxRQUFRQyxFQUFSLENBQVcsUUFBWCxFQUFxQixZQUFNO0FBQ3pCLDZCQUFZLE1BQVo7QUFDRCxDQUZEOztBQUlBRCxRQUFRQyxFQUFSLENBQVcsbUJBQVgsRUFBZ0MsWUFBTTtBQUNwQyw2QkFBWSxNQUFaO0FBQ0QsQ0FGRDs7QUFJQUQsUUFBUUMsRUFBUixDQUFXLFlBQVgsRUFBeUIsWUFBTTtBQUM3Qiw2QkFBWSxNQUFaO0FBQ0QsQ0FGRDs7QUFJ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QURSO0FBRUVDLGFBQUssQ0FDSCxjQURHLEVBRUgsWUFGRyxFQUdILGFBSEcsQ0FGUCxFQVBPLEVBYVA7QUFDRUQsY0FBTSxjQURSO0FBRUVDLGFBQUssQ0FBQztBQUNKQyxrQkFBUSxZQURKO0FBRUpDLG1CQUFTLEVBQUNFLE9BQU8sS0FBUixFQUZMLEVBQUQsQ0FGUCxFQWJPLENBREQsRUFQRjtBQTBCTkMsYUFBUyxDQUNQLElBQUksa0JBQVFDLFFBQVIsQ0FBaUJDLGNBQXJCLENBQW9DO0FBQ2xDQyxlQUFTLFlBRHlCO0FBRWxDQyxnQkFBVSxJQUZ3QixFQUFwQyxDQURPLENBMUJILEVBQVIsRUE2QjBCLFVBQUNDLEdBQUQsRUFBTUMsS0FBTixFQUFnQjtBQUN0QztBQUNILEdBL0JEO0FBZ0NELENBcENEOztBQXNDQSIsImZpbGUiOiJndWxwZmlsZS5iYWJlbC5qcyIsInNvdXJjZVJvb3QiOiIvaG9tZS9nYXJsaWNiL3N0dWR5L3Rva2VuL2Fic29sdXRlIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBBYnNvbHV0ZSBBdXRob3JzLlxuLy9cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IGJhYmVsIGZyb20gJ2d1bHAtYmFiZWwnO1xuaW1wb3J0IGNoaWxkUHJvY2VzcyBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBlc2xpbnQgZnJvbSAnZ3VscC1lc2xpbnQnO1xuaW1wb3J0IGdlbmVyYXRlUHVzaEtleSBmcm9tICcuL3NlcnZlci9wdXNoL2dlbl9wdXNoX2tleSc7XG5pbXBvcnQgZ3VscCBmcm9tICdndWxwJztcbmltcG9ydCBtb2NoYSBmcm9tICdndWxwLW1vY2hhJztcbmltcG9ydCBub2RlbW9uIGZyb20gJ2d1bHAtbm9kZW1vbic7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBydW5TZXF1ZW5jZSBmcm9tICdydW4tc2VxdWVuY2UnO1xuaW1wb3J0IHNvdXJjZW1hcHMgZnJvbSAnZ3VscC1zb3VyY2VtYXBzJztcbmltcG9ydCB1bmRlZlRhc2tUb0RlZmF1bHQgZnJvbSAnZ3VscC11bmRlZi10YXNrLXRvLWRlZmF1bHQnO1xuaW1wb3J0IHdlYnBhY2sgZnJvbSAnd2VicGFjayc7XG5cbnByb2Nlc3Mub24oJ2V4aXQnLCAoKSA9PiB7XG4gIHJ1blNlcXVlbmNlKCdzdG9wJyk7XG59KTtcblxucHJvY2Vzcy5vbignU0lHSU5UJywgKCkgPT4ge1xuICBydW5TZXF1ZW5jZSgnc3RvcCcpO1xufSk7XG5cbnByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgKCkgPT4ge1xuICBydW5TZXF1ZW5jZSgnc3RvcCcpO1xufSk7XG5cbnByb2Nlc3Mub24oJ2Rpc2Nvbm5lY3QnLCAoKSA9PiB7XG4gIHJ1blNlcXVlbmNlKCdzdG9wJyk7XG59KTtcblxuZ3VscC50YXNrKCdkZWZhdWx0JywgWydoZWxwJ10pO1xuXG5ndWxwLnRhc2soJ2hlbHAnLCAoKSA9PiB7XG4gIC8vIFRPRE8oemlubyk6IFdlIHNob3VsZCBpbXBsZW1lbnQgdGhpcyBjb21tYW5kLlxufSk7XG5cbmd1bHAudGFzaygnYnVpbGRfc2VydmVyJywgKCkgPT4ge1xuICByZXR1cm4gZ3VscC5zcmMoWycuL3NlcnZlci8qKi8qLmpzJ10pXG4gICAgLnBpcGUoc291cmNlbWFwcy5pbml0KCkpXG4gICAgLnBpcGUoYmFiZWwoKSlcbiAgICAub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfSlcbiAgICAucGlwZShzb3VyY2VtYXBzLndyaXRlKCcuJyxcbiAgICAgIHtzb3VyY2VSb290OiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnc2VydmVyJyl9KSlcbiAgICAucGlwZShndWxwLmRlc3QocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJ291dCcsICdzZXJ2ZXInKSkpO1xufSk7XG5cbmd1bHAudGFzaygnbGludCcsIChmaW5pc2gpID0+IHtcbiAgcnVuU2VxdWVuY2UoJ2xpbnRfc2VydmVyJywgJ2xpbnRfcm91dGVyJywgZmluaXNoKTtcbn0pO1xuXG5ndWxwLnRhc2soJ2xpbnRfc2VydmVyJywgKGZpbmlzaCkgPT4ge1xuICByZXR1cm4gZ3VscC5zcmMoWycuL3NlcnZlci8qKi8qLmpzJywgJyEuL3NlcnZlci8qKi8qLnJvdXRlci5qcycsXG4gICAgJyEuL3NlcnZlci9wdXNoL3B1c2hfa2V5LmpzJ10pXG4gICAgLnBpcGUoZXNsaW50KCkpXG4gICAgLnBpcGUoZXNsaW50LmZvcm1hdCgpKVxuICAgIC5waXBlKGVzbGludC5mYWlsQWZ0ZXJFcnJvcigpKTtcbn0pO1xuXG5ndWxwLnRhc2soJ2xpbnRfcm91dGVyJywgKGZpbmlzaCkgPT4ge1xuICByZXR1cm4gZ3VscC5zcmMoWycuL3NlcnZlci8qKi8qLnJvdXRlci5qcyddKVxuICAgIC5waXBlKGVzbGludCh7XG4gICAgICAncnVsZXMnOiB7XG4gICAgICAgICdyZXF1aXJlLWpzZG9jJzogWydlcnJvcicsIHtcbiAgICAgICAgICAncmVxdWlyZSc6IHtcbiAgICAgICAgICAgICdNZXRob2REZWZpbml0aW9uJzogZmFsc2UsXG4gICAgICAgICAgICAnQ2xhc3NEZWNsYXJhdGlvbic6IGZhbHNlfX1dfX0pKVxuICAgIC5waXBlKGVzbGludC5mb3JtYXQoKSlcbiAgICAucGlwZShlc2xpbnQuZmFpbEFmdGVyRXJyb3IoKSk7XG59KTtcblxuZ3VscC50YXNrKCdwdXNoX2tleScsICgpID0+IHtcbiAgZ2VuZXJhdGVQdXNoS2V5KCk7XG59KTtcblxuZ3VscC50YXNrKCdzdGFydCcsICgpID0+IHtcbiAgcnVuU2VxdWVuY2UoXG4gICAgJ3N0YXJ0X2RiJyxcbiAgICAnbGludCcsXG4gICAgJ3B1c2hfa2V5JyxcbiAgICAnYnVpbGRfc2VydmVyJyxcbiAgICAnYnVpbGRfY2xpZW50JyxcbiAgICAnc3RhcnRfc2VydmVyJyk7XG59KTtcblxuZ3VscC50YXNrKCdzdGFydF9zZXJ2ZXInLCAoKSA9PiB7XG4gIG5vZGVtb24oe1xuICAgIHNjcmlwdDogJ3NlcnZlci5qcycsXG4gICAgY3dkOiAnb3V0L3NlcnZlcicsXG4gIH0pO1xufSk7XG5cbmd1bHAudGFzaygnc3RhcnRfZGInLCAoZmluaXNoKSA9PiB7XG4gIGNoaWxkUHJvY2Vzcy5leGVjKFxuICAgICdtb25nb2QgLS1mb3JrIC0tZGJwYXRoIGRhdGFiYXNlIC0tbG9ncGF0aCBkYXRhYmFzZS9sb2cnLCAoZXJyb3IpID0+IHtcbiAgICAgIGlmIChlcnJvcilcbiAgICAgICAgY29uc29sZS5sb2coJ0FscmVhZHkgcnVubmluZyBtb25nbyBEQiBkYWVtb24uLicpO1xuICAgICAgZWxzZVxuICAgICAgICBjb25zb2xlLmxvZygnUnVubmluZyBtb25nbyBEQiBkYWVtb24uLicpO1xuICAgICAgZmluaXNoKCk7XG4gICAgfSk7XG59KTtcblxuLy8gRklYTUUoemlubyk6IFRoaXMgY29tbWFuZCBpcyBub3Qgd29ya2luZyB3ZWxsIGluIHNvbWUgY2FzZXMuIChlLmcuIENUUkwgKyBDKVxuZ3VscC50YXNrKCdzdG9wJywgKGZpbmlzaCkgPT4ge1xuICBjaGlsZFByb2Nlc3MuZXhlYygnbW9uZ28gYWRtaW4gLS1ldmFsIFwiZGIuc2h1dGRvd25TZXJ2ZXIoKTtcIicsIChlcnJvcikgPT4ge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZmluaXNoKCk7XG4gICAgfSwgMTAwMCk7XG4gIH0pO1xufSk7XG5cbmd1bHAudGFzaygnYm9vdHN0cmFwX3Rlc3QnLCAoKSA9PiB7XG4gIGd1bHAuc3JjKFsnYm9vdHN0cmFwL3Rlc3QvdGVzdC0qLmpzJ10sIHtyZWFkOiBmYWxzZX0pXG4gICAgLnBpcGUobW9jaGEoKSlcbiAgICAub25jZSgnZXJyb3InLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfSlcbiAgICAub25jZSgnZW5kJywgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5leGl0KCk7XG4gICAgfSk7XG59KTtcblxuZ3VscC50YXNrKCdidWlsZF9jbGllbnQnLCAoKSA9PiB7XG4gIGd1bHAuc3JjKFtwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnY2xpZW50JywgJ2luZGV4Lmh0bWwnKSxcbiAgICBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnY2xpZW50JywgJ3NlcnZpY2Utd29ya2VyLmpzJyldKVxuICAgIC5waXBlKGd1bHAuZGVzdChwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnb3V0JywgJ2NsaWVudCcpKSk7XG4gIHdlYnBhY2soe1xuICAgIHdhdGNoOiB0cnVlLFxuICAgIGNvbnRleHQ6IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICdjbGllbnQnKSxcbiAgICBlbnRyeTogJy4vYXBwLmpzJyxcbiAgICBvdXRwdXQ6IHtcbiAgICAgIHBhdGg6IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICdvdXQnLCAnY2xpZW50JywgJ2phdmFzY3JpcHQnKSxcbiAgICAgIGZpbGVuYW1lOiAnYnVuZGxlLmpzJ30sXG4gICAgbW9kdWxlOiB7XG4gICAgICBydWxlczogW3tcbiAgICAgICAgdGVzdDogL1xcLmpzJC8sXG4gICAgICAgIHVzZTogW3tcbiAgICAgICAgICBsb2FkZXI6ICdiYWJlbC1sb2FkZXInLFxuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIHByZXNldHM6IFtcbiAgICAgICAgICAgICAgWydlczIwMTUtd2l0aG91dC1zdHJpY3QnXV19fV19LFxuICAgICAge1xuICAgICAgICB0ZXN0OiAvXFwuc2NzcyQvLFxuICAgICAgICB1c2U6IFtcbiAgICAgICAgICAnc3R5bGUtbG9hZGVyJyxcbiAgICAgICAgICAnY3NzLWxvYWRlcicsXG4gICAgICAgICAgJ3Nhc3MtbG9hZGVyJ119LFxuICAgICAge1xuICAgICAgICB0ZXN0OiAvXFwuKHBuZ3xqcGcpJC8sXG4gICAgICAgIHVzZTogW3tcbiAgICAgICAgICBsb2FkZXI6ICd1cmwtbG9hZGVyJyxcbiAgICAgICAgICBvcHRpb25zOiB7bGltaXQ6IDEwMDAwfX1dfV19LFxuICAgIHBsdWdpbnM6IFtcbiAgICAgIG5ldyB3ZWJwYWNrLm9wdGltaXplLlVnbGlmeUpzUGx1Z2luKHtcbiAgICAgICAgaW5jbHVkZTogL1xcLm1pblxcLmpzJC8sXG4gICAgICAgIG1pbmltaXplOiB0cnVlfSldfSwgKGVyciwgc3RhdHMpID0+IHtcbiAgICAgIC8vIEZJWE1FKGNzLWxlZSkgc2F2ZSBsb2cgaW4gZmlsZVxuICB9KTtcbn0pO1xuXG51bmRlZlRhc2tUb0RlZmF1bHQoZ3VscCk7XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "gulpfile.babel.js"
      ],
      "names": [
        "process",
        "on",
        "task",
        "src",
        "pipe",
        "init",
        "error",
        "console",
        "log",
        "write",
        "sourceRoot",
        "resolve",
        "__dirname",
        "dest",
        "finish",
        "format",
        "failAfterError",
        "script",
        "cwd",
        "exec",
        "setTimeout",
        "read",
        "once",
        "exit",
        "watch",
        "context",
        "entry",
        "output",
        "path",
        "filename",
        "module",
        "rules",
        "test",
        "use",
        "loader",
        "options",
        "presets",
        "limit",
        "plugins",
        "optimize",
        "UglifyJsPlugin",
        "include",
        "minimize",
        "err",
        "stats"
      ],
      "mappings": "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",
      "file": "gulpfile.babel.js",
      "sourceRoot": "/home/garlicb/study/token/absolute",
      "sourcesContent": [
        "// Copyright (c) 2017 The Absolute Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport babel from 'gulp-babel';\nimport childProcess from 'child_process';\nimport eslint from 'gulp-eslint';\nimport generatePushKey from './server/push/gen_push_key';\nimport gulp from 'gulp';\nimport mocha from 'gulp-mocha';\nimport nodemon from 'gulp-nodemon';\nimport path from 'path';\nimport runSequence from 'run-sequence';\nimport sourcemaps from 'gulp-sourcemaps';\nimport undefTaskToDefault from 'gulp-undef-task-to-default';\nimport webpack from 'webpack';\n\nprocess.on('exit', () => {\n  runSequence('stop');\n});\n\nprocess.on('SIGINT', () => {\n  runSequence('stop');\n});\n\nprocess.on('uncaughtException', () => {\n  runSequence('stop');\n});\n\nprocess.on('disconnect', () => {\n  runSequence('stop');\n});\n\ngulp.task('default', ['help']);\n\ngulp.task('help', () => {\n  // TODO(zino): We should implement this command.\n});\n\ngulp.task('build_server', () => {\n  return gulp.src(['./server/**/*.js'])\n    .pipe(sourcemaps.init())\n    .pipe(babel())\n    .on('error', (error) => {\n      console.log(error);\n    })\n    .pipe(sourcemaps.write('.',\n      {sourceRoot: path.resolve(__dirname, 'server')}))\n    .pipe(gulp.dest(path.resolve(__dirname, 'out', 'server')));\n});\n\ngulp.task('lint', (finish) => {\n  runSequence('lint_server', 'lint_router', finish);\n});\n\ngulp.task('lint_server', (finish) => {\n  return gulp.src(['./server/**/*.js', '!./server/**/*.router.js',\n    '!./server/push/push_key.js'])\n    .pipe(eslint())\n    .pipe(eslint.format())\n    .pipe(eslint.failAfterError());\n});\n\ngulp.task('lint_router', (finish) => {\n  return gulp.src(['./server/**/*.router.js'])\n    .pipe(eslint({\n      'rules': {\n        'require-jsdoc': ['error', {\n          'require': {\n            'MethodDefinition': false,\n            'ClassDeclaration': false}}]}}))\n    .pipe(eslint.format())\n    .pipe(eslint.failAfterError());\n});\n\ngulp.task('push_key', () => {\n  generatePushKey();\n});\n\ngulp.task('start', () => {\n  runSequence(\n    'start_db',\n    'lint',\n    'push_key',\n    'build_server',\n    'build_client',\n    'start_server');\n});\n\ngulp.task('start_server', () => {\n  nodemon({\n    script: 'server.js',\n    cwd: 'out/server',\n  });\n});\n\ngulp.task('start_db', (finish) => {\n  childProcess.exec(\n    'mongod --fork --dbpath database --logpath database/log', (error) => {\n      if (error)\n        console.log('Already running mongo DB daemon..');\n      else\n        console.log('Running mongo DB daemon..');\n      finish();\n    });\n});\n\n// FIXME(zino): This command is not working well in some cases. (e.g. CTRL + C)\ngulp.task('stop', (finish) => {\n  childProcess.exec('mongo admin --eval \"db.shutdownServer();\"', (error) => {\n    setTimeout(() => {\n      finish();\n    }, 1000);\n  });\n});\n\ngulp.task('bootstrap_test', () => {\n  gulp.src(['bootstrap/test/test-*.js'], {read: false})\n    .pipe(mocha())\n    .once('error', () => {\n      process.exit(1);\n    })\n    .once('end', () => {\n      process.exit();\n    });\n});\n\ngulp.task('build_client', () => {\n  gulp.src([path.resolve(__dirname, 'client', 'index.html'),\n    path.resolve(__dirname, 'client', 'service-worker.js')])\n    .pipe(gulp.dest(path.resolve(__dirname, 'out', 'client')));\n  webpack({\n    watch: true,\n    context: path.resolve(__dirname, 'client'),\n    entry: './app.js',\n    output: {\n      path: path.resolve(__dirname, 'out', 'client', 'javascript'),\n      filename: 'bundle.js'},\n    module: {\n      rules: [{\n        test: /\\.js$/,\n        use: [{\n          loader: 'babel-loader',\n          options: {\n            presets: [\n              ['es2015-without-strict']]}}]},\n      {\n        test: /\\.scss$/,\n        use: [\n          'style-loader',\n          'css-loader',\n          'sass-loader']},\n      {\n        test: /\\.(png|jpg)$/,\n        use: [{\n          loader: 'url-loader',\n          options: {limit: 10000}}]}]},\n    plugins: [\n      new webpack.optimize.UglifyJsPlugin({\n        include: /\\.min\\.js$/,\n        minimize: true})]}, (err, stats) => {\n      // FIXME(cs-lee) save log in file\n  });\n});\n\nundefTaskToDefault(gulp);\n"
      ]
    },
    "mtime": 1501137354671
  },
  "{\"filename\":\"/home/garlicb/study/token/absolute/server/push/gen_push_key.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{\"strict\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/home/garlicb/study/token/absolute/server/push\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.25.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "fs",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "fs"
              }
            ]
          },
          {
            "source": "./push_key",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "pushKeys"
              }
            ]
          },
          {
            "source": "web-push",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "webpush"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "generatePushKey"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "generatePushKey",
              "exported": "default"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/home/garlicb/study/token/absolute/server/push/gen_push_key.js",
      "filenameRelative": "/home/garlicb/study/token/absolute/server/push/gen_push_key.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "strict": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "gen_push_key.js",
      "sourceFileName": "gen_push_key.js",
      "sourceRoot": "/home/garlicb/study/token/absolute/server/push",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/home/garlicb/study/token/absolute/server/push",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "gen_push_key"
    },
    "ignored": false,
    "code": "Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = generatePushKey;\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _push_key = require('./push_key');\n\nvar _push_key2 = _interopRequireDefault(_push_key);\n\nvar _webPush = require('web-push');\n\nvar _webPush2 = _interopRequireDefault(_webPush);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n *  Load push key if key exist else generate and load\n */\nfunction generatePushKey() {\n  if (_push_key2.default.pushVapidKeys.privateKey === undefined || _push_key2.default.pushVapidKeys.privateKey === '') {\n    console.log('generate push key');\n    var vapidKeys = _webPush2.default.generateVAPIDKeys();\n    _push_key2.default.pushVapidKeys.privateKey = vapidKeys.privateKey;\n    _push_key2.default.pushVapidKeys.publicKey = vapidKeys.publicKey;\n\n    writeClientPushPubkey(vapidKeys.publicKey);\n    writeServerPusKey(_push_key2.default);\n  }\n}\n\n/**\n * Write push vapid public key for client, client only must know public key\n * @param {string} pubKey vapid public key for client side\n */\n// Copyright (c) 2017 The Absolute Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nfunction writeClientPushPubkey(pubKey) {\n  var path = 'client/push/push_key.js';\n  _fs2.default.writeFileSync(path, 'export default {\\n' + '  \\'pushVapidKeys\\': {\\n' + ('    \\'publicKey\\': \\'' + _push_key2.default.pushVapidKeys.publicKey + '\\'\\n  }\\n}'));\n}\n\n/**\n * Write push keys for server.\n * @param {json} pushKeys pushServerKey and pushVapidKeys for server\n */\nfunction writeServerPusKey(pushKeys) {\n  var path = 'server/push/push_key.js';\n  _fs2.default.writeFileSync(path, 'export default {\\n' + ('  \\'pushServerKey\\': \\'' + pushKeys.pushServerKey + '\\',\\n') + '  \\'pushVapidKeys\\': {\\n' + ('    \\'publicKey\\': \\'' + pushKeys.pushVapidKeys.publicKey + '\\',\\n') + ('    \\'privateKey\\': \\'' + pushKeys.pushVapidKeys.privateKey + '\\',\\n') + '  },\\n};');\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbl9wdXNoX2tleS5qcyJdLCJuYW1lcyI6WyJnZW5lcmF0ZVB1c2hLZXkiLCJwdXNoVmFwaWRLZXlzIiwicHJpdmF0ZUtleSIsInVuZGVmaW5lZCIsImNvbnNvbGUiLCJsb2ciLCJ2YXBpZEtleXMiLCJnZW5lcmF0ZVZBUElES2V5cyIsInB1YmxpY0tleSIsIndyaXRlQ2xpZW50UHVzaFB1YmtleSIsIndyaXRlU2VydmVyUHVzS2V5IiwicHViS2V5IiwicGF0aCIsIndyaXRlRmlsZVN5bmMiLCJwdXNoS2V5cyIsInB1c2hTZXJ2ZXJLZXkiXSwibWFwcGluZ3MiOiI7OztrQkFxQndCQSxlOztBQVB4Qjs7OztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBOzs7QUFHZSxTQUFTQSxlQUFULEdBQTJCO0FBQ3hDLE1BQUcsbUJBQVNDLGFBQVQsQ0FBdUJDLFVBQXZCLEtBQXNDQyxTQUF0QyxJQUNFLG1CQUFTRixhQUFULENBQXVCQyxVQUF2QixLQUFzQyxFQUQzQyxFQUMrQztBQUM3Q0UsWUFBUUMsR0FBUixDQUFZLG1CQUFaO0FBQ0EsUUFBTUMsWUFBWSxrQkFBUUMsaUJBQVIsRUFBbEI7QUFDQSx1QkFBU04sYUFBVCxDQUF1QkMsVUFBdkIsR0FBb0NJLFVBQVVKLFVBQTlDO0FBQ0EsdUJBQVNELGFBQVQsQ0FBdUJPLFNBQXZCLEdBQW1DRixVQUFVRSxTQUE3Qzs7QUFFQUMsMEJBQXNCSCxVQUFVRSxTQUFoQztBQUNBRTtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7QUFsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBMEJBLFNBQVNELHFCQUFULENBQStCRSxNQUEvQixFQUF1QztBQUNyQyxNQUFNQyxPQUFPLHlCQUFiO0FBQ0EsZUFBR0MsYUFBSCxDQUFpQkQsSUFBakIsRUFDRSwrRUFFMEIsbUJBQVNYLGFBQVQsQ0FBdUJPLFNBRmpELGdCQURGO0FBSUQ7O0FBRUQ7Ozs7QUFJQSxTQUFTRSxpQkFBVCxDQUEyQkksUUFBM0IsRUFBcUM7QUFDbkMsTUFBTUYsT0FBTyx5QkFBYjtBQUNBLGVBQUdDLGFBQUgsQ0FBaUJELElBQWpCLEVBQ0Usb0RBQzBCRSxTQUFTQyxhQURuQyxzRUFHMEJELFNBQVNiLGFBQVQsQ0FBdUJPLFNBSGpELDBDQUkyQk0sU0FBU2IsYUFBVCxDQUF1QkMsVUFKbEQsd0JBREY7QUFPRCIsImZpbGUiOiJnZW5fcHVzaF9rZXkuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvZ2FybGljYi9zdHVkeS90b2tlbi9hYnNvbHV0ZS9zZXJ2ZXIvcHVzaCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAxNyBUaGUgQWJzb2x1dGUgQXV0aG9ycy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcHVzaEtleXMgZnJvbSAnLi9wdXNoX2tleSc7XG5pbXBvcnQgd2VicHVzaCBmcm9tICd3ZWItcHVzaCc7XG5cbi8qKlxuICogIExvYWQgcHVzaCBrZXkgaWYga2V5IGV4aXN0IGVsc2UgZ2VuZXJhdGUgYW5kIGxvYWRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2VuZXJhdGVQdXNoS2V5KCkge1xuICBpZihwdXNoS2V5cy5wdXNoVmFwaWRLZXlzLnByaXZhdGVLZXkgPT09IHVuZGVmaW5lZFxuICAgIHx8IHB1c2hLZXlzLnB1c2hWYXBpZEtleXMucHJpdmF0ZUtleSA9PT0gJycpIHtcbiAgICBjb25zb2xlLmxvZygnZ2VuZXJhdGUgcHVzaCBrZXknKTtcbiAgICBjb25zdCB2YXBpZEtleXMgPSB3ZWJwdXNoLmdlbmVyYXRlVkFQSURLZXlzKCk7XG4gICAgcHVzaEtleXMucHVzaFZhcGlkS2V5cy5wcml2YXRlS2V5ID0gdmFwaWRLZXlzLnByaXZhdGVLZXk7XG4gICAgcHVzaEtleXMucHVzaFZhcGlkS2V5cy5wdWJsaWNLZXkgPSB2YXBpZEtleXMucHVibGljS2V5O1xuXG4gICAgd3JpdGVDbGllbnRQdXNoUHVia2V5KHZhcGlkS2V5cy5wdWJsaWNLZXkpO1xuICAgIHdyaXRlU2VydmVyUHVzS2V5KHB1c2hLZXlzKTtcbiAgfVxufVxuXG4vKipcbiAqIFdyaXRlIHB1c2ggdmFwaWQgcHVibGljIGtleSBmb3IgY2xpZW50LCBjbGllbnQgb25seSBtdXN0IGtub3cgcHVibGljIGtleVxuICogQHBhcmFtIHtzdHJpbmd9IHB1YktleSB2YXBpZCBwdWJsaWMga2V5IGZvciBjbGllbnQgc2lkZVxuICovXG5mdW5jdGlvbiB3cml0ZUNsaWVudFB1c2hQdWJrZXkocHViS2V5KSB7XG4gIGNvbnN0IHBhdGggPSAnY2xpZW50L3B1c2gvcHVzaF9rZXkuanMnO1xuICBmcy53cml0ZUZpbGVTeW5jKHBhdGgsXG4gICAgYGV4cG9ydCBkZWZhdWx0IHtcXG5gICtcbiAgICBgICBcXCdwdXNoVmFwaWRLZXlzXFwnOiB7XFxuYCArXG4gICAgICBgICAgIFxcJ3B1YmxpY0tleVxcJzogXFwnJHtwdXNoS2V5cy5wdXNoVmFwaWRLZXlzLnB1YmxpY0tleX1cXCdcXG4gIH1cXG59YCk7XG59XG5cbi8qKlxuICogV3JpdGUgcHVzaCBrZXlzIGZvciBzZXJ2ZXIuXG4gKiBAcGFyYW0ge2pzb259IHB1c2hLZXlzIHB1c2hTZXJ2ZXJLZXkgYW5kIHB1c2hWYXBpZEtleXMgZm9yIHNlcnZlclxuICovXG5mdW5jdGlvbiB3cml0ZVNlcnZlclB1c0tleShwdXNoS2V5cykge1xuICBjb25zdCBwYXRoID0gJ3NlcnZlci9wdXNoL3B1c2hfa2V5LmpzJztcbiAgZnMud3JpdGVGaWxlU3luYyhwYXRoLFxuICAgIGBleHBvcnQgZGVmYXVsdCB7XFxuYCArXG4gICAgYCAgXFwncHVzaFNlcnZlcktleVxcJzogXFwnJHtwdXNoS2V5cy5wdXNoU2VydmVyS2V5fVxcJyxcXG5gICtcbiAgICBgICBcXCdwdXNoVmFwaWRLZXlzXFwnOiB7XFxuYCArXG4gICAgICBgICAgIFxcJ3B1YmxpY0tleVxcJzogXFwnJHtwdXNoS2V5cy5wdXNoVmFwaWRLZXlzLnB1YmxpY0tleX1cXCcsXFxuYCArXG4gICAgICBgICAgIFxcJ3ByaXZhdGVLZXlcXCc6IFxcJyR7cHVzaEtleXMucHVzaFZhcGlkS2V5cy5wcml2YXRlS2V5fVxcJyxcXG5gICtcbiAgICBgICB9LFxcbn07YCk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "gen_push_key.js"
      ],
      "names": [
        "generatePushKey",
        "pushVapidKeys",
        "privateKey",
        "undefined",
        "console",
        "log",
        "vapidKeys",
        "generateVAPIDKeys",
        "publicKey",
        "writeClientPushPubkey",
        "writeServerPusKey",
        "pubKey",
        "path",
        "writeFileSync",
        "pushKeys",
        "pushServerKey"
      ],
      "mappings": ";;;kBAqBwBA,e;;AAPxB;;;;AACA;;;;AACA;;;;;;AAEA;;;AAGe,SAASA,eAAT,GAA2B;AACxC,MAAG,mBAASC,aAAT,CAAuBC,UAAvB,KAAsCC,SAAtC,IACE,mBAASF,aAAT,CAAuBC,UAAvB,KAAsC,EAD3C,EAC+C;AAC7CE,YAAQC,GAAR,CAAY,mBAAZ;AACA,QAAMC,YAAY,kBAAQC,iBAAR,EAAlB;AACA,uBAASN,aAAT,CAAuBC,UAAvB,GAAoCI,UAAUJ,UAA9C;AACA,uBAASD,aAAT,CAAuBO,SAAvB,GAAmCF,UAAUE,SAA7C;;AAEAC,0BAAsBH,UAAUE,SAAhC;AACAE;AACD;AACF;;AAED;;;;AAlCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA0BA,SAASD,qBAAT,CAA+BE,MAA/B,EAAuC;AACrC,MAAMC,OAAO,yBAAb;AACA,eAAGC,aAAH,CAAiBD,IAAjB,EACE,+EAE0B,mBAASX,aAAT,CAAuBO,SAFjD,gBADF;AAID;;AAED;;;;AAIA,SAASE,iBAAT,CAA2BI,QAA3B,EAAqC;AACnC,MAAMF,OAAO,yBAAb;AACA,eAAGC,aAAH,CAAiBD,IAAjB,EACE,oDAC0BE,SAASC,aADnC,sEAG0BD,SAASb,aAAT,CAAuBO,SAHjD,0CAI2BM,SAASb,aAAT,CAAuBC,UAJlD,wBADF;AAOD",
      "file": "gen_push_key.js",
      "sourceRoot": "/home/garlicb/study/token/absolute/server/push",
      "sourcesContent": [
        "// Copyright (c) 2017 The Absolute Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport fs from 'fs';\nimport pushKeys from './push_key';\nimport webpush from 'web-push';\n\n/**\n *  Load push key if key exist else generate and load\n */\nexport default function generatePushKey() {\n  if(pushKeys.pushVapidKeys.privateKey === undefined\n    || pushKeys.pushVapidKeys.privateKey === '') {\n    console.log('generate push key');\n    const vapidKeys = webpush.generateVAPIDKeys();\n    pushKeys.pushVapidKeys.privateKey = vapidKeys.privateKey;\n    pushKeys.pushVapidKeys.publicKey = vapidKeys.publicKey;\n\n    writeClientPushPubkey(vapidKeys.publicKey);\n    writeServerPusKey(pushKeys);\n  }\n}\n\n/**\n * Write push vapid public key for client, client only must know public key\n * @param {string} pubKey vapid public key for client side\n */\nfunction writeClientPushPubkey(pubKey) {\n  const path = 'client/push/push_key.js';\n  fs.writeFileSync(path,\n    `export default {\\n` +\n    `  \\'pushVapidKeys\\': {\\n` +\n      `    \\'publicKey\\': \\'${pushKeys.pushVapidKeys.publicKey}\\'\\n  }\\n}`);\n}\n\n/**\n * Write push keys for server.\n * @param {json} pushKeys pushServerKey and pushVapidKeys for server\n */\nfunction writeServerPusKey(pushKeys) {\n  const path = 'server/push/push_key.js';\n  fs.writeFileSync(path,\n    `export default {\\n` +\n    `  \\'pushServerKey\\': \\'${pushKeys.pushServerKey}\\',\\n` +\n    `  \\'pushVapidKeys\\': {\\n` +\n      `    \\'publicKey\\': \\'${pushKeys.pushVapidKeys.publicKey}\\',\\n` +\n      `    \\'privateKey\\': \\'${pushKeys.pushVapidKeys.privateKey}\\',\\n` +\n    `  },\\n};`);\n}\n"
      ]
    },
    "mtime": 1501048813339
  },
  "{\"filename\":\"/home/garlicb/study/token/absolute/server/push/push_key.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{\"strict\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/home/garlicb/study/token/absolute/server/push\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.25.0": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/home/garlicb/study/token/absolute/server/push/push_key.js",
      "filenameRelative": "/home/garlicb/study/token/absolute/server/push/push_key.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "strict": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "push_key.js",
      "sourceFileName": "push_key.js",
      "sourceRoot": "/home/garlicb/study/token/absolute/server/push",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/home/garlicb/study/token/absolute/server/push",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "push_key"
    },
    "ignored": false,
    "code": "Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = {\n  'pushServerKey': 'AAAAuU4aFAY:APA91bHL6gDxgTYMHD7q2hTKD_6GwYOcDhPTjiM14vYWwRwAmkl3rijIRnK-9-NdFvy8hrcXvi8IvBLhEPOUQZxZ2N00roSkH1U3tLX7sOGxzsKkTXHp9R2i-GbmYVkK9yYz0RF_wZfP',\n  'pushVapidKeys': {\n    'publicKey': 'BIIRaJLExnx2i0LLD8ROMfWazpjE7dQJo6UQo9zqbqu-rNSJFK2tyKM1FykWvrJSi9062j3xurAovn3jmli7Fws',\n    'privateKey': 'i7q575WlkOLcctkNeYhKs_OBAcWAuOgPef5d-aGjTyM'\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1c2hfa2V5LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztrQkFBZTtBQUNiLG1CQUFpQiwwSkFESjtBQUViLG1CQUFpQjtBQUNmLGlCQUFhLHlGQURFO0FBRWYsa0JBQWM7QUFGQztBQUZKLEMiLCJmaWxlIjoicHVzaF9rZXkuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvZ2FybGljYi9zdHVkeS90b2tlbi9hYnNvbHV0ZS9zZXJ2ZXIvcHVzaCIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IHtcbiAgJ3B1c2hTZXJ2ZXJLZXknOiAnQUFBQXVVNGFGQVk6QVBBOTFiSEw2Z0R4Z1RZTUhEN3EyaFRLRF82R3dZT2NEaFBUamlNMTR2WVd3UndBbWtsM3JpaklSbkstOS1OZEZ2eThocmNYdmk4SXZCTGhFUE9VUVp4WjJOMDByb1NrSDFVM3RMWDdzT0d4enNLa1RYSHA5UjJpLUdibVlWa0s5eVl6MFJGX3daZlAnLFxuICAncHVzaFZhcGlkS2V5cyc6IHtcbiAgICAncHVibGljS2V5JzogJ0JJSVJhSkxFeG54MmkwTExEOFJPTWZXYXpwakU3ZFFKbzZVUW85enFicXUtck5TSkZLMnR5S00xRnlrV3ZySlNpOTA2MmozeHVyQW92bjNqbWxpN0Z3cycsXG4gICAgJ3ByaXZhdGVLZXknOiAnaTdxNTc1V2xrT0xjY3RrTmVZaEtzX09CQWNXQXVPZ1BlZjVkLWFHalR5TScsXG4gIH0sXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "push_key.js"
      ],
      "names": [],
      "mappings": ";;;kBAAe;AACb,mBAAiB,0JADJ;AAEb,mBAAiB;AACf,iBAAa,yFADE;AAEf,kBAAc;AAFC;AAFJ,C",
      "file": "push_key.js",
      "sourceRoot": "/home/garlicb/study/token/absolute/server/push",
      "sourcesContent": [
        "export default {\n  'pushServerKey': 'AAAAuU4aFAY:APA91bHL6gDxgTYMHD7q2hTKD_6GwYOcDhPTjiM14vYWwRwAmkl3rijIRnK-9-NdFvy8hrcXvi8IvBLhEPOUQZxZ2N00roSkH1U3tLX7sOGxzsKkTXHp9R2i-GbmYVkK9yYz0RF_wZfP',\n  'pushVapidKeys': {\n    'publicKey': 'BIIRaJLExnx2i0LLD8ROMfWazpjE7dQJo6UQo9zqbqu-rNSJFK2tyKM1FykWvrJSi9062j3xurAovn3jmli7Fws',\n    'privateKey': 'i7q575WlkOLcctkNeYhKs_OBAcWAuOgPef5d-aGjTyM',\n  },\n};\n"
      ]
    },
    "mtime": 1501048813339
  }
}